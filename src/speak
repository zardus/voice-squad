#!/bin/bash
# speak â€” Send text to the voice interface for TTS playback
# Usage: speak "Workers are finishing up the auth module"

if [ -z "$1" ]; then
  echo "Usage: speak \"text to speak\"" >&2
  exit 1
fi

if [ -z "$VOICE_TOKEN" ]; then
  echo "Error: VOICE_TOKEN not set" >&2
  exit 1
fi

VOICE_URL="${VOICE_SERVER_URL:-http://localhost:3000}"
curl -s -X POST "${VOICE_URL}/api/speak" \
  -H "Content-Type: application/json" \
  -d "{\"text\": $(printf '%s' "$1" | jq -Rs .), \"token\": \"$VOICE_TOKEN\"}" \
  > /dev/null
